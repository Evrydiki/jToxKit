var jToxKit={version:"2.1.0"};!function(e,t){e.ui=t.extend(e.ui,{formatString:function(e,n,s){for(var r=e.split(/\{\{([^}]+)\}\}/),a=r.length,o="",i=0;o+=r[i++],!(i>=a);++i){var c=t.path(n,r[i]);o+=null!=c?c:"function"==typeof s?s(r[i]):"string"==typeof s?s:""}return o},addParameter:function(e,t){return e+("&?".indexOf(e.charAt(e.length-1))==-1?e.indexOf("?")>0?"&":"?":"")+t},removeParameter:function(e,t){return e.replace(new RegExp("(.*?.*)("+t+"=[^&s$]*&?)(.*)"),"$1$3")},parseURL:function(e){var t=document.createElement("a");return t.href=e,{source:e,protocol:t.protocol.replace(":",""),host:t.hostname,port:t.port,query:t.search,params:function(){for(var e,n,s,r={},a=t.search.replace(/^\?/,"").split("&"),o=a.length,i=0;i<o;i++)a[i]&&(e=a[i].split("="),n=e.length>1?decodeURIComponent(e[1].replace(/\+/g," ")):"",e[0].indexOf("[]")==e[0].length-2?(s=r[e[0].slice(0,-2)],void 0===s?r[e[0].slice(0,-2)]=[n]:s.push(n)):r[e[0]]=n);return r}(),file:(t.pathname.match(/\/([^\/?#]+)$/i)||[,""])[1],hash:t.hash.replace("#",""),path:t.pathname.replace(/^([^\/])/,"/$1"),relative:(t.href.match(/tps?:\/\/[^\/]+(.+)/)||[,""])[1],segments:t.pathname.replace(/^\//,"").split("/")}},modifyURL:function(e,t,n){var s,r,a=document.createElement("a"),o=n?t+"="+encodeURIComponent(n):"";if(a.href=e,r=a.search,s=r.match(new RegExp(t+"=[\\S^&]+")))r=r.replace(s[0],o);else{if(!o)return;"?"==r.charAt(0)?r="?"+o:r+=("&"==r.slice(-1)?"":"&")+o}return a.search=r,a.href},escapeHTML:function(e){var t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,function(e){return t[e]})},formatUnits:function(e){return e.toString().replace(/(^|\W)u(\w)/g,"$1&#x00B5;$2").replace(/\^\(?([\-\d]+)\)?/g,"<sup>$1</sup>").replace(/ /g,"&nbsp;")}}),e.Translation=function(e){t.extend(!0,this,e)},e.Translation.prototype={__expects:["translateResponse"],init:function(){t.pass(this,e.Translation,"init")},parseResponse:function(n,s){t.pass(this,e.Translation,"parseResponse");var r=this.translateResponse(n,s),a=this;t.each(this.listeners,function(e){t.act(e,e.afterTranslation,r,s,a)})}};var n={study:{fields:/topcategory[_sh]*|endpointcategory[_sh]*|guidance_[_sh]*|reference[_sh]*|reference_owner[_sh]*|reference_year[_sh]*|guidance[_sh]*/},composition:{fields:/CORE|COATING|CONSTITUENT|ADDITIVE|IMPURITY|FUNCTIONALISATION|DOPING/}};e.RawSolrTranslation=function(e){this.collapseRules=t.extend(!0,{},n,e&&e.collapseRules)},e.RawSolrTranslation.prototype={init:function(n){t.pass(this,e.RawSolrTranslation,"init")},translateResponse:function(e,n){for(var s=[],r=this,a=function(e,n){t.each(r.collapseRules,function(s,r){var a={};t.each(n,function(e,t){t.match(s.fields)&&(delete n[t],Array.isArray(e)&&1==e.length&&(e=e[0]),a[t]=e)}),void 0===e._extended_&&(e._extended_={}),void 0===e._extended_[r]?e._extended_[r]=[a]:e._extended_[r].push(a)}),t.each(n,function(t,n){Array.isArray(t)&&1==t.length&&(t=t[0]),e[n]=t})},o=0,i=e.response.docs.length;o<i;++o){var c=e.response.docs[o],p=e.expanded[c.s_uuid],l={};a(l,c);for(var d=0,u=p.docs.length;d<u;++d)a(l,p.docs[d]);s.push(l)}return{entries:s,stats:t.extend({},e.stats,e.responseHeader),facets:t.extend({},e.facet_counts.facet_fields||e.facets,e.facet_counts.facet_pivot),paging:{start:e.response.start,count:e.response.docs.length,total:e.response.numFound,pageSize:parseInt(e.responseHeader.params.rows)}}}},e.NestedSolrTranslation=function(e){this.nestingField=e&&e.nestingField||"type_s"},e.NestedSolrTranslation.prototype={init:function(n){t.pass(this,e.NestedSolrTranslation,"init")},translateResponse:function(e,n){for(var s=e.response.docs,r=0,a=s.length;r<a;++r){for(var o=s[r],i={},c=0,p=o._childDocuments_.length;c<p;++c){var l=o._childDocuments_[c],d=l[this.nestingField];void 0===i[d]&&(i[d]=[]),i[d].push(l)}delete o._childDocuments_,o._extended_=i}return{entries:s,stats:t.extend({},e.stats,e.responseHeader),facets:e.facets,paging:{start:e.response.start,count:e.response.docs.length,total:e.response.numFound,pageSize:parseInt(e.responseHeader.params.rows)}}}},"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=jToxKit:(this.jToxKit=t.extend({},this.jToxKit,jToxKit),"function"==typeof define&&define.amd&&define(jToxKit))}(jToxKit,asSys);
